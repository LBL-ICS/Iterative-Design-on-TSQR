file:///C:/Users/blair/OneDrive/Documents/Desktop/iterative_tsqr/src/main/scala/hh_datapath_chisel.scala
### scala.reflect.internal.FatalError: 
  ThisType(value <local hh_datapath_1>) for sym which is not a class
     while compiling: file:///C:/Users/blair/OneDrive/Documents/Desktop/iterative_tsqr/src/main/scala/hh_datapath_chisel.scala
        during phase: globalPhase=<no phase>, enteringPhase=parser
     library version: version 2.13.7
    compiler version: version 2.13.7
  reconstructed args: -classpath <WORKSPACE>\.bloop\root\bloop-bsp-clients-classes\classes-Metals-BlZL38xkQra270DcC6nyKQ==;<HOME>\AppData\Local\bloop\cache\semanticdb\com.sourcegraph.semanticdb-javac.0.9.10\semanticdb-javac-0.9.10.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\scala-library\2.13.7\scala-library-2.13.7.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chiseltest_2.13\0.5.0\chiseltest_2.13-0.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3_2.13\3.5.0\chisel3_2.13-3.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\treadle_2.13\1.5.0\treadle_2.13-1.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scalatest\scalatest_2.13\3.1.4\scalatest_2.13-3.1.4.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\utest_2.13\0.7.9\utest_2.13-0.7.9.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\net\java\dev\jna\jna\5.10.0\jna-5.10.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\scala-reflect\2.13.7\scala-reflect-2.13.7.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3-macros_2.13\3.5.0\chisel3-macros_2.13-3.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3-core_2.13\3.5.0\chisel3-core_2.13-3.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\os-lib_2.13\0.8.0\os-lib_2.13-0.8.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\firrtl_2.13\1.5.0\firrtl_2.13-1.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-jline\2.12.1\scala-jline-2.12.1.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scalactic\scalactic_2.13\3.1.4\scalactic_2.13-3.1.4.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-xml_2.13\1.2.0\scala-xml_2.13-1.2.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-sbt\test-interface\1.0\test-interface-1.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\portable-scala\portable-scala-reflect_2.13\0.1.1\portable-scala-reflect_2.13-0.1.1.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\geny_2.13\0.7.0\geny_2.13-0.7.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\antlr\antlr4-runtime\4.9.3\antlr4-runtime-4.9.3.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\google\protobuf\protobuf-java\3.18.0\protobuf-java-3.18.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\github\scopt\scopt_2.13\3.7.1\scopt_2.13-3.7.1.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\net\jcazevedo\moultingyaml_2.13\0.4.2\moultingyaml_2.13-0.4.2.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-native_2.13\3.6.12\json4s-native_2.13-3.6.12.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\apache\commons\commons-text\1.9\commons-text-1.9.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\io\github\alexarchambault\data-class_2.13\0.2.5\data-class_2.13-0.2.5.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-parallel-collections_2.13\1.0.4\scala-parallel-collections_2.13-1.0.4.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\fusesource\jansi\jansi\1.11\jansi-1.11.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\github\nscala-time\nscala-time_2.13\2.22.0\nscala-time_2.13-2.22.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\yaml\snakeyaml\1.26\snakeyaml-1.26.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-core_2.13\3.6.12\json4s-core_2.13-3.6.12.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\apache\commons\commons-lang3\3.11\commons-lang3-3.11.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\joda-time\joda-time\2.10.1\joda-time-2.10.1.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\joda\joda-convert\2.2.0\joda-convert-2.2.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-ast_2.13\3.6.12\json4s-ast_2.13-3.6.12.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-scalap_2.13\3.6.12\json4s-scalap_2.13-3.6.12.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\thoughtworks\paranamer\paranamer\2.8\paranamer-2.8.jar -Xplugin-require:semanticdb -Yrangepos -Ymacro-expand:discard -Ycache-plugin-class-loader:last-modified -Ypresentation-any-thread

  last tree to typer: Ident(_CURSOR_tk)
       tree position: line 753 of file:///C:/Users/blair/OneDrive/Documents/Desktop/iterative_tsqr/src/main/scala/hh_datapath_chisel.scala
            tree tpe: <error>
              symbol: value <error> in class <error>
   symbol definition: val <error>: <error> (a TermSymbol)
      symbol package: <none>
       symbol owners: value <error> -> class <error>
           call site: <none> in <none>

== Source file context for tree position ==

   750             hqr10.in_en := true.B
   751             hqr10.in_a.Re := d4(bw-1,bw/2)
   752             hqr10.in_a.Im := d4((bw/2)-1,0)
   753             hqr10.in_b.Re := _CURSOR_tk
   754             hqr10.in_b.Im := 0.U
   755             d5_update := Cat(hqr10.out_s.Re,hqr10.out_s.Im)
   756 

occurred in the presentation compiler.

presentation compiler configuration:
Scala version: 2.13.7
Classpath:
<WORKSPACE>\.bloop\root\bloop-bsp-clients-classes\classes-Metals-BlZL38xkQra270DcC6nyKQ== [exists ], <HOME>\AppData\Local\bloop\cache\semanticdb\com.sourcegraph.semanticdb-javac.0.9.10\semanticdb-javac-0.9.10.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\scala-library\2.13.7\scala-library-2.13.7.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chiseltest_2.13\0.5.0\chiseltest_2.13-0.5.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3_2.13\3.5.0\chisel3_2.13-3.5.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\treadle_2.13\1.5.0\treadle_2.13-1.5.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scalatest\scalatest_2.13\3.1.4\scalatest_2.13-3.1.4.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\utest_2.13\0.7.9\utest_2.13-0.7.9.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\net\java\dev\jna\jna\5.10.0\jna-5.10.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\scala-reflect\2.13.7\scala-reflect-2.13.7.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3-macros_2.13\3.5.0\chisel3-macros_2.13-3.5.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3-core_2.13\3.5.0\chisel3-core_2.13-3.5.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\os-lib_2.13\0.8.0\os-lib_2.13-0.8.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\firrtl_2.13\1.5.0\firrtl_2.13-1.5.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-jline\2.12.1\scala-jline-2.12.1.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scalactic\scalactic_2.13\3.1.4\scalactic_2.13-3.1.4.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-xml_2.13\1.2.0\scala-xml_2.13-1.2.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-sbt\test-interface\1.0\test-interface-1.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\portable-scala\portable-scala-reflect_2.13\0.1.1\portable-scala-reflect_2.13-0.1.1.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\geny_2.13\0.7.0\geny_2.13-0.7.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\antlr\antlr4-runtime\4.9.3\antlr4-runtime-4.9.3.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\google\protobuf\protobuf-java\3.18.0\protobuf-java-3.18.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\github\scopt\scopt_2.13\3.7.1\scopt_2.13-3.7.1.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\net\jcazevedo\moultingyaml_2.13\0.4.2\moultingyaml_2.13-0.4.2.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-native_2.13\3.6.12\json4s-native_2.13-3.6.12.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\apache\commons\commons-text\1.9\commons-text-1.9.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\io\github\alexarchambault\data-class_2.13\0.2.5\data-class_2.13-0.2.5.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-parallel-collections_2.13\1.0.4\scala-parallel-collections_2.13-1.0.4.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\fusesource\jansi\jansi\1.11\jansi-1.11.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\github\nscala-time\nscala-time_2.13\2.22.0\nscala-time_2.13-2.22.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\yaml\snakeyaml\1.26\snakeyaml-1.26.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-core_2.13\3.6.12\json4s-core_2.13-3.6.12.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\apache\commons\commons-lang3\3.11\commons-lang3-3.11.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\joda-time\joda-time\2.10.1\joda-time-2.10.1.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\joda\joda-convert\2.2.0\joda-convert-2.2.0.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-ast_2.13\3.6.12\json4s-ast_2.13-3.6.12.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-scalap_2.13\3.6.12\json4s-scalap_2.13-3.6.12.jar [exists ], <HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\thoughtworks\paranamer\paranamer\2.8\paranamer-2.8.jar [exists ]
Options:
-Yrangepos -Xplugin-require:semanticdb


action parameters:
offset: 26035
uri: file:///C:/Users/blair/OneDrive/Documents/Desktop/iterative_tsqr/src/main/scala/hh_datapath_chisel.scala
text:
```scala


 /*//*****************************************
 * 10/19/2023
 * Author: Blair Reasoner
 * Release version: 1
 * 
 * NOTE: Main module to be converted to 
 * RawModule in the future
 * **************************************/
*/



package tsqr_hh_datapath
import Binary_Modules.BinaryDesigns._
import FP_Modules.FloatingPointDesigns._
import chisel3._
import chisel3.util._
import Chisel.{log2Ceil, log2Floor}
import chiseltest.RawTester.test
import chisel3.tester._
import chisel3.{RawModule, withClockAndReset}
import ComplexModules.FPComplex._

import java.io.PrintWriter
import scala.collection.mutable

object hh_datapath_chisel{

  def main(args: Array[String]) : Unit = {
    val sw2 = new PrintWriter("hh_datapath_16_chisel_test.v")
    sw2.println(getVerilogString(new hh_datapath(12, 32, 16, 16)))
    sw2.close()
  }
//main datapath design module
class hh_datapath_1(name:Int, bw:Int, streaming_width:Int, CNT_WIDTH: Int, Iterations: Int)extends Module {
    val io = IO {
      new Bundle() {
        val clk = Input(Clock())
        val rst = Input(Bool())
        val hh_cnt = Input(UInt((CNT_WIDTH).W))
        val d1_rdy = Input(Bool())
        val d1_vld = Input(Bool())
        val d2_rdy = Input(Bool())
        val d2_vld = Input(Bool())
        val vk1_rdy = Input(Bool())
        val vk1_vld = Input(Bool())
        val d3_rdy = Input(Bool()) 
        val d3_vld = Input(Bool())
        val tk_rdy = Input(Bool())
        val tk_vld = Input(Bool())
        val d4_rdy = Input(Bool())
        val d4_vld = Input(Bool())
        val d5_rdy = Input(Bool())
        val d5_vld = Input(Bool())
        val yjp_rdy = Input(Bool())
        val yjp_vld = Input(Bool())
        val yj_sft = Input(Bool())
        val d4_sft = Input(Bool())
        val hh_din = Input(UInt((streaming_width*bw).W))
        val hh_dout = Output(UInt((streaming_width*bw).W))
      }
    }
    withClockAndReset (io.clk, io.rst){


    def counter(max: UInt, enable: Bool) = {
      val x = RegInit(0.asUInt(max.getWidth.W))
          x := Mux(~enable,0.U,Mux(x === max, 0.U, x + 1.U))
          x
      }

    def pulse(n: UInt, enable: Bool) = counter((n),enable) === (n)

    var x = log2Ceil(iterations)



    val yj_reg_vec = Reg(Vec(streaming_width/2,UInt(((log2Ceil(streaming_width)*13+24+129+22)*2*bw).W)))
    val yj0 = Reg(UInt((streaming_width*bw).W)) 

    when(io.rst){
      yj0 := 0.U
      for(i <- 0 until streaming_width/2){
        yj_reg_vec(i):= 0.U}
   }.elsewhen(io.yj_sft){
      yj0 := yj_reg_vec(streaming_width/2-1)(streaming_width*bw-1,0)
      //yj_reg_vec(0) := Cat(io.hh_din,yj_reg_vec(0)(((log2Ceil(streaming_width)*13+12+129+10-2)*2*bw -1),streaming_width*32))
      yj_reg_vec(0) := Cat(io.hh_din,yj_reg_vec(0)(((log2Ceil(streaming_width)*13+24+129+22)*2*bw -1),streaming_width*bw))
      for(i <- 1 until streaming_width/2){
      //yj_reg_vec(i):= Cat(yj_reg_vec(i-1)(streaming_width*32-1,0),yj_reg_vec(i)(((log2Ceil(streaming_width)*13+12+129+10-2)*2*bw-1),streaming_width*32))
      yj_reg_vec(i):= Cat(yj_reg_vec(i-1)(streaming_width*bw-1,0),yj_reg_vec(i)(((log2Ceil(streaming_width)*13+24+129+22)*2*bw-1),streaming_width*bw))
    }}

/*

    val yj0 = Reg(UInt((streaming_width*bw).W))
   //
    val yj_reg_1 = Reg(UInt(((log2Ceil(streaming_width)*13+24+129+22)*streaming_width*(bw/8)).W))
    val yj_reg_2 = Reg(UInt(((log2Ceil(streaming_width)*13+24+129+22)*streaming_width*(bw/8)).W))
    val yj_reg_3 = Reg(UInt(((log2Ceil(streaming_width)*13+24+129+22)*streaming_width*(bw/8)).W))
    val yj_reg_4 = Reg(UInt(((log2Ceil(streaming_width)*13+24+129+22)*streaming_width*(bw/8)).W))
    
    val yj_reg_5 = Reg(UInt(((log2Ceil(streaming_width)*13+24+129+22)*streaming_width*(bw/8)).W))
    val yj_reg_6 = Reg(UInt(((log2Ceil(streaming_width)*13+24+129+22)*streaming_width*(bw/8)).W))
    val yj_reg_7 = Reg(UInt(((log2Ceil(streaming_width)*13+24+129+22)*streaming_width*(bw/8)).W))
    val yj_reg_8 = Reg(UInt(((log2Ceil(streaming_width)*13+24+129+22)*streaming_width*(bw/8)).W))
    //


    when(io.rst){
      yj_reg_1 := 0.U
      yj_reg_2 := 0.U
      yj_reg_3 := 0.U
      yj_reg_4 := 0.U
      yj_reg_5 := 0.U
      yj_reg_6 := 0.U
      yj_reg_7 := 0.U
      yj_reg_8 := 0.U
      yj0 := 0.U
    }.elsewhen(io.yj_sft){


      yj_reg_8 := Cat(yj_reg_7(streaming_width*bw-1,0),yj_reg_8(((log2Ceil(streaming_width)*13+24+129+22+2-2)*streaming_width*(bw/8))-1,streaming_width*bw))
      yj_reg_7 := Cat(yj_reg_6(streaming_width*bw-1,0),yj_reg_7(((log2Ceil(streaming_width)*13+24+129+22+2-2)*streaming_width*(bw/8))-1,streaming_width*bw))
      yj_reg_6 := Cat(yj_reg_5(streaming_width*bw-1,0),yj_reg_6(((log2Ceil(streaming_width)*13+24+129+22+2-2)*streaming_width*(bw/8))-1,streaming_width*bw))
      yj_reg_5 := Cat(yj_reg_4(streaming_width*bw-1,0),yj_reg_5(((log2Ceil(streaming_width)*13+24+129+22+2-2)*streaming_width*(bw/8))-1,streaming_width*bw))
      yj_reg_4 := Cat(yj_reg_3(streaming_width*bw-1,0),yj_reg_4(((log2Ceil(streaming_width)*13+24+129+22+2-2)*streaming_width*(bw/8))-1,streaming_width*bw))
      yj_reg_3 := Cat(yj_reg_2(streaming_width*bw-1,0),yj_reg_3(((log2Ceil(streaming_width)*13+24+129+22+2-2)*streaming_width*(bw/8))-1,streaming_width*bw))
      yj_reg_2 := Cat(yj_reg_1(streaming_width*bw-1,0),yj_reg_2(((log2Ceil(streaming_width)*13+24+129+22+2-2)*streaming_width*(bw/8))-1,streaming_width*bw))
      yj_reg_1 := Cat(io.hh_din,yj_reg_1(((log2Ceil(streaming_width)*13+24+129+22+2-2)*streaming_width*(bw/8))-1,streaming_width*bw))
      yj0 := yj_reg_8(streaming_width*bw-1,0)
    }
    */
    val ddot_din_a = Wire(UInt((streaming_width*bw).W))
    val ddot_din_b = Wire(UInt((streaming_width*bw).W))
    val ddot_dout = Wire(UInt(bw.W))
    val vk = Reg(UInt((streaming_width*bw).W))
    val d1 = Wire(UInt((bw/2).W))
    val d3 = Wire(UInt((bw/2).W))
    val d4 = Wire(UInt(bw.W))
    val vk_update = Wire(UInt((streaming_width*bw).W))

  

    val x1 = Wire(UInt(bw.W))
    val d2 = Wire(UInt((bw/2).W))
    val vk1 = Wire(UInt(bw.W))
    val tk = Wire(UInt((bw/2).W))
    val d5 = Wire(UInt(bw.W))


    when(io.d1_rdy){
      ddot_din_a := io.hh_din
    }.elsewhen(io.d3_rdy){
      ddot_din_a := vk
    }.otherwise{
      ddot_din_a := ddot_din_a
    }

    when(io.d1_rdy){
      ddot_din_b := io.hh_din
    }.elsewhen(io.d3_rdy){
      ddot_din_b := vk
    }.otherwise{
      ddot_din_b := ddot_din_b
    }
    
    when(io.vk1_vld){
     // vk := vk_update
    }.otherwise{
      vk := vk
    }

   /////VIVADO///// val d4_update_reg = Reg(UInt(((26)*bw).W))
   val d4_update_reg = Reg(UInt(((126)*bw).W))
    when(io.rst){
      d4_update := 0.U
      d4_update_reg := 0.U
    }.elsewhen(io.d4_sft){
      d4_update := d4_update_reg(bw-1, 0)
      //d4_update_reg := Cat(ddot_dout, d4_update_reg(26*bw-1,bw))//126
      d4_update_reg := Cat(ddot_dout, d4_update_reg(126*bw-1,bw))
    }

    when(io.d1_vld){
      d1 := ddot_dout(bw-1,bw/2)
    }.otherwise{
      d1 := d1
    }

    when(io.d3_vld){
      d3 := ddot_dout(bw-1,bw/2)
    }.otherwise{
      d3 := d3
    }

    when(io.d1_rdy){
      x1 := x1_update
    }.otherwise{
      x1 := x1
    }

    when(io.d2_vld){
      d2 := d2_update
    }.otherwise{
      d2 := d2
    }

    when(io.vk1_vld){
      vk1 := vk1_update
    }.otherwise{
      vk1 := vk1
    }

    when(io.tk_vld){
      tk := tk_update
    }.otherwise{
      tk := tk
    }

    when(io.d5_rdy){
      d4 := d4_update
    }.otherwise{
      d4 := d4
    }

    when(io.d5_vld){
      d5 := d5_update
    }.otherwise{
      d5 := d5_reg
    }
    
    val myVec = Wire(Vec(streaming_width, UInt(width = bw.W)))
    for(i <- 0 until streaming_width ){ 
      myVec(i) := io.hh_din(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))
    }
    when(io.rst){
      x1_update := 0.U
    }.elsewhen(io.d1_rdy){
      x1_update := myVec(io.hh_cnt)
    }.otherwise{
      x1_update := 0.U
    }

  val myNewVec = Wire(Vec(streaming_width, UInt(width = bw.W)))

    for(i <- 0 until streaming_width ){
      myNewVec(streaming_width-1-i) := myVec(io.hh_cnt+1.U + i.U)
    }

    val myNewWire = Wire(UInt((streaming_width*bw).W))
    myNewWire := myNewVec.asUInt
    when(io.rst){
      vk_update := 0.U
    }.elsewhen(io.vk1_vld){
      vk_update := (Cat(vk1,myNewWire)>>((io.hh_cnt+1.U)*bw.U))

    }.otherwise{
      vk_update := 0.U
    }


   val ddot = Module(new FP_DDOT_dp_complex(bw/2,streaming_width,name)).io

   for(i <- 0 until streaming_width ){ 
      ddot.in_a(i).Re := (ddot_din_a(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1)))))(bw-1,bw/2)
      ddot.in_b(i).Re := (ddot_din_b(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1)))))(bw-1,bw/2)
      ddot.in_a(i).Im := ((ddot_din_a(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1)))))((bw/2)-1,0))^("h8000_0000".U)//flip sign of a to make complex conjugate with xor
      ddot.in_b(i).Im := (ddot_din_b(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1)))))((bw/2)-1,0)
    }

    val ddot2 = Module(new FP_DDOT_dp_complex(bw/2,streaming_width,name)).io

   for(i <- 0 until streaming_width ){ 
      ddot2.in_a(i).Re := //vk
      ddot2.in_b(i).Re := //yj
      ddot2.in_a(i).Im := 
      ddot2.in_b(i).Im := 
    }

    val acc2_input_pulse_layer = for(i <- 0 until x)yield{
            val acc2_pulse = pulse((((1<<(i+1))-1).U), cnt_en_2(i))
            acc2_pulse
            }

            val acc2_reg_pulse_layer = for(i <- 0 until x)yield{
            val acc2_pulse = pulse((((1<<(i+2))-1).U), reg_en_2(i))
            acc2_pulse
            }


            val acc2_add_layer = for(i <- 0 until x)yield{
            val add = Module(new FPComplexAdder_v2(bw/2,name)).io
            add.in_en := true.B
            add
            }

            val acc2_reg_layer = for(i <- 0 until x)yield{
            val sft_reg = RegInit(0.U((bw).W))
            sft_reg
            }

            when(rst){
                acc2_add_layer(0).in_a.Re := 0.U
                acc2_add_layer(0).in_b.Re := 0.U
                acc2_add_layer(0).in_a.Im := 0.U
                acc2_add_layer(0).in_b.Im := 0.U
            }.elsewhen(acc2_input_pulse_layer(0)){
                acc2_add_layer(0).in_a.Re := RegNext(ddot2.out_s.Re)
                acc2_add_layer(0).in_b.Re := ddot2.out_s.Re
                acc2_add_layer(0).in_a.Im := RegNext(ddot2.out_s.Im)
                acc2_add_layer(0).in_b.Im := ddot2.out_s.Im
            }.otherwise{
                acc2_add_layer(0).in_a.Re := 0.U
                acc2_add_layer(0).in_b.Re := 0.U
                acc2_add_layer(0).in_a.Im := 0.U
                acc2_add_layer(0).in_b.Im := 0.U

            }

            for(i <- 0 until x-1){
                when(rst){
                    acc2_reg_layer(i) := 0.U
                }.elsewhen(acc2_reg_pulse_layer(i)){
                    acc2_reg_layer(i) := Cat(acc2_add_layer(i).out_s.Re,acc2_add_layer(i).out_s.Im)
                }.otherwise{
                    acc2_reg_layer(i) := acc2_reg_layer(i)
                }
            }

            when(rst || ~reg_en_2(x-1)){
                     acc2_reg_layer(x-1) := 0.U
                }.elsewhen(reg_en_2(x-1)  && 3(acc2_input_pulse_layer(x-1),13,true.B)){
                     acc2_reg_layer(x-1) := Cat(acc2_add_layer(x-1).out_s.Re,acc2_add_layer(x-1).out_s.Im)
                }.otherwise{
                     acc2_reg_layer(x-1) := acc2_reg_layer(x-1)
                }

            for(i <- 1 until x){
                when(rst){
                  acc2_add_layer(i).in_a.Re := 0.U
                  acc2_add_layer(i).in_b.Re := 0.U
                  acc2_add_layer(i).in_a.Im := 0.U
                  acc2_add_layer(i).in_b.Im := 0.U
                }.elsewhen(acc2_input_pulse_layer(i)){
                  acc2_add_layer(i).in_a.Re := acc2_reg_layer(i-1)(bw-1,bw/2)
                  acc2_add_layer(i).in_b.Re := acc2_add_layer(i-1).out_s.Re
                  acc2_add_layer(i).in_a.Im := acc2_reg_layer(i-1)(bw/2-1,0)
                  acc2_add_layer(i).in_b.Im := acc2_add_layer(i-1).out_s.Im
                }.otherwise{
                  acc2_add_layer(i).in_a.Re := 0.U
                  acc2_add_layer(i).in_b.Re := 0.U
                  acc2_add_layer(i).in_a.Im := 0.U
                  acc2_add_layer(i).in_b.Im := 0.U
                }
            }

    //ddot_dout := Cat(ddot.out_s.Re,ddot.out_s.Im)//7/2/24

    

    val hqr3 = Module(new FP_square_root_newfpu(bw/2,3,name)).io//stays the same for complex
    hqr3.in_en := true.B
    hqr3.in_a := d1
    d2 := hqr3.out_s
    
    

    /*
    class sqrtbb_viv(bw:Int)extends BlackBox{
        val io = IO {
            new Bundle() {
                val aclk = Input(Clock())
                val s_axis_a_tvalid = Input(Bool())
                val s_axis_a_tdata = Input(UInt((bw).W))
                val m_axis_result_tdata = Output((UInt((bw).W)))
                val m_axis_result_tvalid = Output(Bool())
                val s_axis_a_tready = Output(Bool())
            }
        }
    }

    val hqr3 = Module(new sqrtbb_viv(bw/2)).io
    hqr3.aclk := io.clk
    hqr3.s_axis_a_tvalid := true.B
    hqr3.s_axis_a_tdata := d1
    d2_update := hqr3.m_axis_result_tdata
*/


   /*val hqr5= Module(new hqr5(bw)).io
   hqr5.in_a := x1
   hqr5.in_b := d2
   vk1_update := hqr5.out_s*/

   val hqr5= Module(new hqr5_complex(bw/2,name)).io
   hqr5.in_a.Re := x1(bw-1,bw/2)
   hqr5.in_a.Im := x1((bw/2)-1,0)
   hqr5.in_b.Re := d2
   hqr5.in_b.Im := 0.U
   vk1_update := Cat(hqr5.out_s.Re,hqr5.out_s.Im)



   val hqr7= Module(new hqr7(bw/2,name)).io
   hqr7.in_a := d3
   tk_update := hqr7.out_s


/*
   class divider_viv(bw:Int)extends BlackBox{
        val io = IO {
            new Bundle() {
                val aclk = Input(Clock())
                val s_axis_a_tvalid = Input(Bool())
                val s_axis_a_tdata = Input(UInt((bw).W))
                val s_axis_a_tready = Output(Bool())

                val m_axis_result_tdata = Output((UInt((bw).W)))
                val m_axis_result_tvalid = Output(Bool())


                val s_axis_b_tvalid = Input(Bool())
                val s_axis_b_tdata = Input(UInt((bw).W))
                val s_axis_b_tready = Output(Bool())
            }
        }
    }

    */
   /*
   val hqr7= Module(new divider_viv(bw/2)).io
   hqr7.aclk := io.clk
   hqr7.s_axis_b_tdata := d3
   hqr7.s_axis_b_tvalid := true.B
   hqr7.s_axis_a_tvalid := true.B
   hqr7.s_axis_a_tdata := "hc0000000".U
   tk_update := hqr7.m_axis_result_tdata
   */


   val hqr10= Module(new FPComplexMult_v2(bw/2,name)).io//changes made for complex
   hqr10.in_en := true.B
   hqr10.in_a.Re := d4(bw-1,bw/2)
   hqr10.in_a.Im := d4((bw/2)-1,0)
   hqr10.in_b.Re := tk
   hqr10.in_b.Im := 0.U
   d5_update := Cat(hqr10.out_s.Re,hqr10.out_s.Im)



   val axpy= Module(new axpy_dp_complex(bw/2,streaming_width,name)).io
   axpy.in_a.Re := d5_reg(bw-1,bw/2)
   axpy.in_a.Im := d5_reg((bw/2)-1,0)
   for(i <- 0 until streaming_width ){ 
      axpy.in_b(i).Re := vk(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))(bw-1,bw/2)
      axpy.in_b(i).Im := vk(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))((bw/2)-1,0)

      axpy.in_c(i).Re := yj0(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))(bw-1,bw/2)
      axpy.in_c(i).Im := yj0(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))((bw/2)-1,0)
   }

   val myAxpyVec = Reg(Vec(streaming_width, UInt(width = bw.W)))
   when(io.rst){
    for(i <- 0 until streaming_width){
      myAxpyVec(streaming_width-i-1) := 0.U}
    }.otherwise{
      for(i <- 0 until streaming_width){
        myAxpyVec(streaming_width-i-1) := Cat(axpy.out_s(i).Re,axpy.out_s(i).Im)
      }
    }
    io.hh_dout := myAxpyVec.asUInt
    }


  }
















  class hh_datapath(name:Int, bw:Int, streaming_width:Int, ddot_st:Int, total_st:Int ) extends RawModule{
        val clk = IO(Input(Clock()))
        val rst = IO(Input(Bool()))
        val hh_cnt = IO(Input(UInt((16).W)))
        val d1_rdy = IO(Input(Bool()))
        val d1_vld = IO(Input(Bool()))
        val d2_rdy = IO(Input(Bool()))
        val d2_vld = IO(Input(Bool()))
        val vk1_rdy = IO(Input(Bool()))
        val vk1_vld = IO(Input(Bool()))
        val d3_rdy = IO(Input(Bool()))
        val d3_vld = IO(Input(Bool()))
        val tk_rdy = IO(Input(Bool()))
        val tk_vld = IO(Input(Bool()))
        val d4_rdy = IO(Input(Bool()))
        val d4_vld = IO(Input(Bool()))
        val d5_rdy = IO(Input(Bool()))
        val d5_vld = IO(Input(Bool()))
        val yjp_rdy = IO(Input(Bool()))
        val yjp_vld = IO(Input(Bool()))
        val yj_sft = IO(Input(Bool()))
        val d4_sft = IO(Input(Bool()))
        val hh_din = IO(Input(UInt((streaming_width*bw).W)))
        val hh_dout = IO(Output(UInt((streaming_width*bw).W)))


        val cnt_en_1 = IO(Input(Vec(log2Ceil(total_st/ddot_st), Bool())))
        val reg_en_1 = IO(Input(Vec(log2Ceil(total_st/ddot_st), Bool())))
        val cnt_en_2 = IO(Input(Vec(log2Ceil(total_st/streaming_width), Bool())))
        val reg_en_2 = IO(Input(Vec(log2Ceil(total_st/streaming_width), Bool())))



  
  withClockAndReset (clk,rst){

    def counter(max: UInt, enable: Bool) = {
      val x = RegInit(0.asUInt(max.getWidth.W))
          x := Mux(~enable,0.U,Mux(x === max, 0.U, x + 1.U))
          x
      }

    def pulse(n: UInt, enable: Bool) = counter((n),enable) === (n)

    var ddot1_it = log2Ceil(total_st/ddot_st)
    var ddot2_it = log2Ceil(total_st/streaming_width)


    val x1 = Wire(UInt(bw.W))



    val ddot1_din_a = Wire(UInt((ddot_st*bw).W))
    val ddot1_din_b = Wire(UInt((ddot_st*bw).W))
    val ddot2_din_a = Wire(UInt((streaming_width*bw).W))
    val ddot2_din_b = Wire(UInt((streaming_width*bw).W))



    


    val ddot1 = Module(new FP_DDOT_dp_complex(bw/2,ddot_st,name)).io
    for(i <- 0 until streaming_width ){ 
      ddot1.in_a(i).Re := (ddot1_din_a(ddot_st*bw-(i*bw)-1,(ddot_st*bw-(bw*(i+1)))))(bw-1,bw/2)
      ddot1.in_b(i).Re := (ddot1_din_b(ddot_st*bw-(i*bw)-1,(ddot_st*bw-(bw*(i+1)))))(bw-1,bw/2)
      ddot1.in_a(i).Im := ((ddot1_din_a(ddot_st*bw-(i*bw)-1,(ddot_st*bw-(bw*(i+1)))))((bw/2)-1,0))^("h8000_0000".U)//flip sign of a to make complex conjugate with xor
      ddot1.in_b(i).Im := (ddot1_din_b(ddot_st*bw-(i*bw)-1,(ddot_st*bw-(bw*(i+1)))))((bw/2)-1,0)
    }
    val acc1_input_pulse_layer = for(i <- 0 until ddot1_it)yield{
    val acc1_pulse = pulse((((1<<(i+1))-1).U), cnt_en_1(i))
    acc1_pulse
    }

    val acc1_reg_pulse_layer = for(i <- 0 until ddot1_it)yield{
    val acc1_pulse = pulse((((1<<(i+2))-1).U), reg_en_1(i))
    acc1_pulse
    }


    val acc1_add_layer = for(i <- 0 until ddot1_it)yield{
    val add = Module(new FPComplexAdder_v2(bw/2,name)).io
    add.in_en := true.B
    add
    }

    val acc1_reg_layer = for(i <- 0 until ddot1_it)yield{
    val sft_reg = RegInit(0.U((bw).W))
    sft_reg
    }

    when(rst){
        acc1_add_layer(0).in_a.Re := 0.U
        acc1_add_layer(0).in_b.Re := 0.U
        acc1_add_layer(0).in_a.Im := 0.U
        acc1_add_layer(0).in_b.Im := 0.U
    }.elsewhen(acc1_input_pulse_layer(0)){
        acc1_add_layer(0).in_a.Re := RegNext(ddot1.out_s.Re)
        acc1_add_layer(0).in_b.Re := ddot1.out_s.Re
        acc1_add_layer(0).in_a.Im := RegNext(ddot1.out_s.Im)
        acc1_add_layer(0).in_b.Im := ddot1.out_s.Im
    }.otherwise{
        acc1_add_layer(0).in_a.Re := 0.U
        acc1_add_layer(0).in_b.Re := 0.U
        acc1_add_layer(0).in_a.Im := 0.U
        acc1_add_layer(0).in_b.Im := 0.U

    }

    for(i <- 0 until ddot1_it-1){
        when(rst){
            acc1_reg_layer(i) := 0.U
        }.elsewhen(acc1_reg_pulse_layer(i)){
            acc1_reg_layer(i) := Cat(acc1_add_layer(i).out_s.Re,acc1_add_layer(i).out_s.Im)
        }.otherwise{
            acc1_reg_layer(i) := acc1_reg_layer(i)
        }
    }

    when(rst || ~reg_en_1(ddot1_it-1)){
              acc1_reg_layer(ddot1_it-1) := 0.U
        }.elsewhen(reg_en_1(ddot1_it-1)  && (acc1_input_pulse_layer(ddot1_it-1),13,true.B)){
              acc1_reg_layer(ddot1_it-1) := Cat(acc1_add_layer(ddot1_it-1).out_s.Re,acc1_add_layer(ddot1_it-1).out_s.Im)
        }.otherwise{
              acc1_reg_layer(ddot1_it-1) := acc1_reg_layer(ddot1_it-1)
        }

    for(i <- 1 until ddot1_it){
        when(rst){
          acc1_add_layer(i).in_a.Re := 0.U
          acc1_add_layer(i).in_b.Re := 0.U
          acc1_add_layer(i).in_a.Im := 0.U
          acc1_add_layer(i).in_b.Im := 0.U
        }.elsewhen(acc1_input_pulse_layer(i)){
          acc1_add_layer(i).in_a.Re := acc1_reg_layer(i-1)(bw-1,bw/2)
          acc1_add_layer(i).in_b.Re := acc1_add_layer(i-1).out_s.Re
          acc1_add_layer(i).in_a.Im := acc1_reg_layer(i-1)(bw/2-1,0)
          acc1_add_layer(i).in_b.Im := acc1_add_layer(i-1).out_s.Im
        }.otherwise{
          acc1_add_layer(i).in_a.Re := 0.U
          acc1_add_layer(i).in_b.Re := 0.U
          acc1_add_layer(i).in_a.Im := 0.U
          acc1_add_layer(i).in_b.Im := 0.U
        }
    }


    val hqr3 = Module(new FP_square_root_newfpu(bw/2,3,name)).io//stays the same for complex
    hqr3.in_en := true.B
    hqr3.in_a := acc1_reg_layer(ddot1_it-1)//d1
    //d2 := hqr3.out_s


    val hqr5= Module(new hqr5_complex(bw/2,name)).io
    hqr5.in_a.Re := x1(bw-1,bw/2)
    hqr5.in_a.Im := x1((bw/2)-1,0)
    hqr5.in_b.Re := hqr3.out_s//d2
    hqr5.in_b.Im := 0.U
    //vk1_update := Cat(hqr5.out_s.Re,hqr5.out_s.Im)


    val hqr7= Module(new hqr7(bw/2,name)).io
    hqr7.in_a := acc1_reg_layer(ddot1_it-1)//d3
    //tk_update := hqr7.out_s


    
    val ddot2 = Module(new FP_DDOT_dp_complex(bw/2,streaming_width,name)).io
    for(i <- 0 until streaming_width ){ 
       ddot2.in_a(i).Re := //vk
       ddot2.in_b(i).Re := //yj
       ddot2.in_a(i).Im := 
       ddot2.in_b(i).Im := 
     }


     val acc2_input_pulse_layer = for(i <- 0 until ddot2_it)yield{
            val acc2_pulse = pulse((((1<<(i+1))-1).U), cnt_en_2(i))
            acc2_pulse
            }

            val acc2_reg_pulse_layer = for(i <- 0 until ddot2_it)yield{
            val acc2_pulse = pulse((((1<<(i+2))-1).U), reg_en_2(i))
            acc2_pulse
            }


            val acc2_add_layer = for(i <- 0 until ddot2_it)yield{
            val add = Module(new FPComplexAdder_v2(bw/2,name)).io
            add.in_en := true.B
            add
            }

            val acc2_reg_layer = for(i <- 0 until ddot2_it)yield{
            val sft_reg = RegInit(0.U((bw).W))
            sft_reg
            }

            when(rst){
                acc2_add_layer(0).in_a.Re := 0.U
                acc2_add_layer(0).in_b.Re := 0.U
                acc2_add_layer(0).in_a.Im := 0.U
                acc2_add_layer(0).in_b.Im := 0.U
            }.elsewhen(acc2_input_pulse_layer(0)){
                acc2_add_layer(0).in_a.Re := RegNext(ddot2.out_s.Re)
                acc2_add_layer(0).in_b.Re := ddot2.out_s.Re
                acc2_add_layer(0).in_a.Im := RegNext(ddot2.out_s.Im)
                acc2_add_layer(0).in_b.Im := ddot2.out_s.Im
            }.otherwise{
                acc2_add_layer(0).in_a.Re := 0.U
                acc2_add_layer(0).in_b.Re := 0.U
                acc2_add_layer(0).in_a.Im := 0.U
                acc2_add_layer(0).in_b.Im := 0.U

            }

            for(i <- 0 until ddot2_it-1){
                when(rst){
                    acc2_reg_layer(i) := 0.U
                }.elsewhen(acc2_reg_pulse_layer(i)){
                    acc2_reg_layer(i) := Cat(acc2_add_layer(i).out_s.Re,acc2_add_layer(i).out_s.Im)
                }.otherwise{
                    acc2_reg_layer(i) := acc2_reg_layer(i)
                }
            }

            when(rst || ~reg_en_2(ddot2_it-1)){
                     acc2_reg_layer(ddot2_it-1) := 0.U
                }.elsewhen(reg_en_2(ddot2_it-1)  && (acc2_input_pulse_layer(ddot2_it-1),13,true.B)){
                     acc2_reg_layer(ddot2_it-1) := Cat(acc2_add_layer(ddot2_it-1).out_s.Re,acc2_add_layer(ddot2_it-1).out_s.Im)
                }.otherwise{
                     acc2_reg_layer(ddot2_it-1) := acc2_reg_layer(ddot2_it-1)
                }

            for(i <- 1 until ddot2_it){
                when(rst){
                  acc2_add_layer(i).in_a.Re := 0.U
                  acc2_add_layer(i).in_b.Re := 0.U
                  acc2_add_layer(i).in_a.Im := 0.U
                  acc2_add_layer(i).in_b.Im := 0.U
                }.elsewhen(acc2_input_pulse_layer(i)){
                  acc2_add_layer(i).in_a.Re := acc2_reg_layer(i-1)(bw-1,bw/2)
                  acc2_add_layer(i).in_b.Re := acc2_add_layer(i-1).out_s.Re
                  acc2_add_layer(i).in_a.Im := acc2_reg_layer(i-1)(bw/2-1,0)
                  acc2_add_layer(i).in_b.Im := acc2_add_layer(i-1).out_s.Im
                }.otherwise{
                  acc2_add_layer(i).in_a.Re := 0.U
                  acc2_add_layer(i).in_b.Re := 0.U
                  acc2_add_layer(i).in_a.Im := 0.U
                  acc2_add_layer(i).in_b.Im := 0.U
                }
            }


            val hqr10= Module(new FPComplexMult_v2(bw/2,name)).io//changes made for complex
            hqr10.in_en := true.B
            hqr10.in_a.Re := d4(bw-1,bw/2)
            hqr10.in_a.Im := d4((bw/2)-1,0)
            hqr10.in_b.Re := @@tk
            hqr10.in_b.Im := 0.U
            d5_update := Cat(hqr10.out_s.Re,hqr10.out_s.Im)


            val axpy= Module(new axpy_dp_complex(bw/2,streaming_width,name)).io
            axpy.in_a.Re := d5_reg(bw-1,bw/2)
            axpy.in_a.Im := d5_reg((bw/2)-1,0)
            for(i <- 0 until streaming_width ){ 
               axpy.in_b(i).Re := vk(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))(bw-1,bw/2)
               axpy.in_b(i).Im := vk(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))((bw/2)-1,0)
            
               axpy.in_c(i).Re := yj0(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))(bw-1,bw/2)
               axpy.in_c(i).Im := yj0(streaming_width*bw-(i*bw)-1,(streaming_width*bw-(bw*(i+1))))((bw/2)-1,0)
            }



  }
}
}

```



#### Error stacktrace:

```
scala.reflect.internal.Reporting.abort(Reporting.scala:69)
	scala.reflect.internal.Reporting.abort$(Reporting.scala:65)
	scala.reflect.internal.SymbolTable.abort(SymbolTable.scala:28)
	scala.reflect.internal.Types$ThisType.<init>(Types.scala:1394)
	scala.reflect.internal.Types$UniqueThisType.<init>(Types.scala:1414)
	scala.reflect.internal.Types$ThisType$.apply(Types.scala:1418)
	scala.meta.internal.pc.AutoImportsProvider$$anonfun$autoImports$3.applyOrElse(AutoImportsProvider.scala:74)
	scala.meta.internal.pc.AutoImportsProvider$$anonfun$autoImports$3.applyOrElse(AutoImportsProvider.scala:60)
	scala.collection.immutable.List.collect(List.scala:267)
	scala.meta.internal.pc.AutoImportsProvider.autoImports(AutoImportsProvider.scala:60)
	scala.meta.internal.pc.ScalaPresentationCompiler.$anonfun$autoImports$1(ScalaPresentationCompiler.scala:299)
```
#### Short summary: 

scala.reflect.internal.FatalError: 
  ThisType(value <local hh_datapath_1>) for sym which is not a class
     while compiling: file:///C:/Users/blair/OneDrive/Documents/Desktop/iterative_tsqr/src/main/scala/hh_datapath_chisel.scala
        during phase: globalPhase=<no phase>, enteringPhase=parser
     library version: version 2.13.7
    compiler version: version 2.13.7
  reconstructed args: -classpath <WORKSPACE>\.bloop\root\bloop-bsp-clients-classes\classes-Metals-BlZL38xkQra270DcC6nyKQ==;<HOME>\AppData\Local\bloop\cache\semanticdb\com.sourcegraph.semanticdb-javac.0.9.10\semanticdb-javac-0.9.10.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\scala-library\2.13.7\scala-library-2.13.7.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chiseltest_2.13\0.5.0\chiseltest_2.13-0.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3_2.13\3.5.0\chisel3_2.13-3.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\treadle_2.13\1.5.0\treadle_2.13-1.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scalatest\scalatest_2.13\3.1.4\scalatest_2.13-3.1.4.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\utest_2.13\0.7.9\utest_2.13-0.7.9.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\net\java\dev\jna\jna\5.10.0\jna-5.10.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\scala-reflect\2.13.7\scala-reflect-2.13.7.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3-macros_2.13\3.5.0\chisel3-macros_2.13-3.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\chisel3-core_2.13\3.5.0\chisel3-core_2.13-3.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\os-lib_2.13\0.8.0\os-lib_2.13-0.8.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\edu\berkeley\cs\firrtl_2.13\1.5.0\firrtl_2.13-1.5.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-jline\2.12.1\scala-jline-2.12.1.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scalactic\scalactic_2.13\3.1.4\scalactic_2.13-3.1.4.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-xml_2.13\1.2.0\scala-xml_2.13-1.2.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-sbt\test-interface\1.0\test-interface-1.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\portable-scala\portable-scala-reflect_2.13\0.1.1\portable-scala-reflect_2.13-0.1.1.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\lihaoyi\geny_2.13\0.7.0\geny_2.13-0.7.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\antlr\antlr4-runtime\4.9.3\antlr4-runtime-4.9.3.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\google\protobuf\protobuf-java\3.18.0\protobuf-java-3.18.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\github\scopt\scopt_2.13\3.7.1\scopt_2.13-3.7.1.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\net\jcazevedo\moultingyaml_2.13\0.4.2\moultingyaml_2.13-0.4.2.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-native_2.13\3.6.12\json4s-native_2.13-3.6.12.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\apache\commons\commons-text\1.9\commons-text-1.9.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\io\github\alexarchambault\data-class_2.13\0.2.5\data-class_2.13-0.2.5.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\scala-lang\modules\scala-parallel-collections_2.13\1.0.4\scala-parallel-collections_2.13-1.0.4.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\fusesource\jansi\jansi\1.11\jansi-1.11.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\github\nscala-time\nscala-time_2.13\2.22.0\nscala-time_2.13-2.22.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\yaml\snakeyaml\1.26\snakeyaml-1.26.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-core_2.13\3.6.12\json4s-core_2.13-3.6.12.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\apache\commons\commons-lang3\3.11\commons-lang3-3.11.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\joda-time\joda-time\2.10.1\joda-time-2.10.1.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\joda\joda-convert\2.2.0\joda-convert-2.2.0.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-ast_2.13\3.6.12\json4s-ast_2.13-3.6.12.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\org\json4s\json4s-scalap_2.13\3.6.12\json4s-scalap_2.13-3.6.12.jar;<HOME>\AppData\Local\Coursier\cache\v1\https\repo1.maven.org\maven2\com\thoughtworks\paranamer\paranamer\2.8\paranamer-2.8.jar -Xplugin-require:semanticdb -Yrangepos -Ymacro-expand:discard -Ycache-plugin-class-loader:last-modified -Ypresentation-any-thread

  last tree to typer: Ident(_CURSOR_tk)
       tree position: line 753 of file:///C:/Users/blair/OneDrive/Documents/Desktop/iterative_tsqr/src/main/scala/hh_datapath_chisel.scala
            tree tpe: <error>
              symbol: value <error> in class <error>
   symbol definition: val <error>: <error> (a TermSymbol)
      symbol package: <none>
       symbol owners: value <error> -> class <error>
           call site: <none> in <none>

== Source file context for tree position ==

   750             hqr10.in_en := true.B
   751             hqr10.in_a.Re := d4(bw-1,bw/2)
   752             hqr10.in_a.Im := d4((bw/2)-1,0)
   753             hqr10.in_b.Re := _CURSOR_tk
   754             hqr10.in_b.Im := 0.U
   755             d5_update := Cat(hqr10.out_s.Re,hqr10.out_s.Im)
   756 